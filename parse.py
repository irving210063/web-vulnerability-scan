import requests
from bs4 import BeautifulSoup
import sys
import os 

# URL of the webpage to fetch
alertRef= sys.argv[1] # Replace with the actual URL
url = f'https://www.zaproxy.org/docs/alerts/{alertRef}'
# Sending an HTTP GET request to the URL
response = requests.get(url)

# Check if the request was successful
if response.status_code == 200:
    html_content = response.text

    # Using BeautifulSoup to parse the HTML content
    soup = BeautifulSoup(html_content, 'html.parser')

    # Finding the div with the 'data-attr' attribute set to 'summary'
    summary_div = soup.find('div', {'data-attr': 'summary'})

    # Extracting the text from the summary div
    summary_content = summary_div.prettify() if summary_div else "Summary content not found."

    # Generating a new HTML snippet with the summary content
    new_html = f"""
    <!DOCTYPE html>
    <html>
    <head>
        <title>Description of Vulnerability</title>
        <style>
            body {{
                font-family: Arial, sans-serif;
                margin: 40px;
                background-color: #f0f0f0;
            }}
            .summary-container {{
                background-color: white;
                border-radius: 8px;
                padding: 20px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            }}
            .summary-title {{
                font-size: 24px;
                color: #333;
                margin-bottom: 20px;
            }}
            .summary-content {{
                font-size: 20px;
                color: #666;
            }}
        </style>
    </head>
    <body>
        <div class="summary-container">
            <div class="summary-content">
                {summary_content}
            </div>
        </div>
    </body>
    </html>
    """

    # Writing the HTML content to a file
    file_name = "./templates/Description/Description_for_id_" + alertRef + ".html"
    with open(file_name, 'w') as file:
        file.write(new_html)
    print("HTML file created successfully.")
else:
    print(f"Failed to retrieve HTML content. Status Code: {response.status_code}")
