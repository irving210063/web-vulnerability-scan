import openai
import time
openai.api_key = "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"
question = "How can I solve Missing Anti-clickjacking Header, please give me every solutions to solve it (including HTML setting , python-backend or reverse proxy), please make sure your descriptions are well-organized in a single HTML , I repeat again,  please  'create' a   well-organized  HTML to elaborate all your recommendation steps and the  codes as detail as possible "
answerresponse = openai.ChatCompletion.create(
        model = "gpt-3.5-turbo-0613",    # select model
        messages =[
            {"role":"system","content":"You are now a IT Security Manager"},
            {"role":"user","content":question}
            ],
        #max_tokens = 3000,               # response tokens
        temperature = 1,                # diversity related
        top_p = 1,                   # diversity related
        n = 1,                          # num of response
        )
progress = "Not yet"
while progress != "stop":
    progress = answerresponse["choices"][0]["finish_reason"]
    if progress != "stop":
        continue
    else:
        time.sleep(1)
        answer = answerresponse["choices"][0]["message"]["content"]
print("--------answer type--------")
print(type(answer))
print("------raw anser-----")
print(answer)

start_tag_list = ["<!DOCTYPE html>","<html>"]
end_tag = "</html>"
for tag in start_tag_list:
    start_index = answer.find(tag)
    if start_index != -1:
        break

end_index = answer.find(end_tag) + len(end_tag)
